<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>reveal.js - The HTML Presentation Framework</title>

		<meta name="description" content="A framework for easily creating beautiful presentations using HTML">
		<meta name="author" content="Hakim El Hattab">

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/black.css" id="theme">
		<link rel="stylesheet" href="css/custom.css">

		<!-- Code syntax highlighting -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
				<section>
					<h1 class="giant">D3</h1>
					<p>Data Driven Documents</p>
				</section>

				<section>
					<section>
						<h2>What D3 is</h2>
						<ul>
							<li>A Javascript data visualization library</li>
              <li>Create by Mike Bostock <a href="http://d3js.org/" target="_blank">d3js.org</a></li>
              <li>FAOS</li>
						</ul>
					</section>
					<section>
						<h2>What D3 is not</h2>
						<ul>
							<li>A charting library</li>
							<li>ie - Highcharts and Google charts</li>
							<li>There are no prebuilt .chart methods or functions that you pass data to, for example</li>
						</ul>
					</section>
					<section>
						<h2>What D3 does</h2>
						<ul>
							<li>Binds arbitrary data to the DOM</li>
							<li>Allows you to apply data driven transformation to the document</li>
							<li>Uses transitions, CSS, and SVG</li>
							<li>Provides a set of tools designed to work with data and handle their manipulation</li>
							<li>Has no dependencies</li>
						</ul>
					</section>
				</section>

				<section>
					<section>
						<h2>How D3 works</h2>
						<ul>
							<li>D3 is built the functional pattern</li>
							<li>Similar to jQuery, most functions return the object they operate on</li>
							<li>Data structures and visualizations in D3 are generated by chaining many functions together</li>
							<li>D3 has no dependencies and uses its own selector syntax</li>
						</ul>
					</section>
					<section>
						<h2>D3 Selectors and the DOM</h2>
						<ul>
							<li>Take any simple or complex selectors as arguments, pretty much the same as D3
								<pre><code class="javascript" data-trim>
d3.select('div');
d3.selectAll('div');
								</code></pre>
							</li>
							<li>DOM modification
								<pre><code class="javascript" data-trim>
d3.selectAll('.some-class').html()    // Get inner html
    .text('Some text')                // Set text
    .classed('.a-class')              // Check if has class
    .classed('.set-class', true)      // Set class
    .classed('.remove-class', false)  // Remove class
    .attr('href', 'google.com')
    .style('font-size', '20px')
    .append('h1').text(function() {   // Pass a function
        return getH1Text();
    });
								</code></pre>
							</li>
						</ul>
					</section>
				</section>

				<section>
					<section>
						<h2>Data Binding</h2>
						<ul>
							<li>This is the main functionality D3 offers</li>
							<li>It creates a visual representation of your data</li>
							<li>Updates the visual elements when the data changes</li>
							<li>Removes them when data is no longer in the dataset</li>
						</ul>
					</section>
					<section>
						<h2>D3 Patterns</h2>
						<ul>
							<li>D3 is simply a set of tools without strict rules</li>
							<li>Readable, maintainable, and reusable must have a structure</li>
							<li>Most commonly, an <em>enter-update-exit</em> pattern is used</li>
						</ul>
					</section>
					<section>
						<h2>enter-update-exit</h2>
						<ul>
							<li>Three Steps: Enter, Update, and Exit</li>
							<li>Generally, the following occurs at each step:</li>
              <ul>
                <li><strong>Enter</strong> - Create new data points in the data binding model</li>
                <li><strong>Update</strong> - Change data and styles to represent the current visualization</li>
                <li><strong>Exit</strong> - Remove old data points that are no longer represented</li>
              </ul>
              <li>When visualizing a <strong>single</strong> set of static data, each step will occur <strong>once</strong></li>
            </ul>
					</section>
					<section>
            <h2>enter-update-exit Visually</h2>
            <ul>
              <li>Enter - Returns data selection not represented in the DOM</li>
              <li>Update - Returns selection that currently exists in both the dataset AND the DOM</li>
              <li>Exit - Returns selection that exists in the DOM but is no longer represented in the data</li>
            </ul>
            <img src="img/D3-venn-diagram-3.jpg" alt="venn diagram of enter-update-exit">
          </section>
          <section>
            <h2>Enter</h2>
            <ul>
              <li>The first time you run enter, no div.h-bar element exist, so you select nothing</li>
              <li>.data(data) binds the data to the d3 structure, and enter compares the two selections</li>
              <li>EVERY element in the data is returned, then it creates one for each point</li>
            </ul>
            <pre><code class="javascript" data-trim>
// Enter
d3.select("#bar-chart").selectAll("div.h-bar")
  .data(data)
  .enter()
  .append("div")
    .attr("class", "h-bar")
      .append("span");
            </code></pre>
          </section>
          <section>
            <h2>Update</h2>
            <ul>
              <li>There is no ".update()" method, it's just a conceptual step</li>
              <li>Take all items and update their data bound properties</li>
            </ul>
            <pre><code class="javascript" data-trim>
// Update
d3.select("#bar-chart").selectAll("div.h-bar")
  .data(data)
    .style("width", function (d) {
      return (d * 3) + "px";
    })
    .select("span")
      .text(function (d) {
        return d;
      });
            </code></pre>
          </section>
          <section>
            <h2>Exit</h2>
            <ul>
              <li>Returns items that are in the DOM but no longer in the dataset</li>
              <li>Most commonly, you just .remove() them</li>
            </ul>
            <pre><code class="javascript" data-trim>
// Exit
d3.select("#bar-chart").selectAll("div.h-bar")
  .data(data)
  .exit()
    .remove();
            </code></pre>
          </section>
          <section>
            <h2>Putting it together</h2>
            <ul>
              <li>Putting all the parts together to make a simple visualization using data in an array</li>
              <li>For the first example, we'll use simple data as an array</li>
            </ul>
            <pre><code class="javascript" data-trim>
// The data
var data = [10, 15, 30, 50, 80, 65, 55, 30, 20, 10, 8];
// The render function
function render(data) {
  // Enter...
  // Update...
  // Exit...
}
// Call render
render(data);
            </code></pre>
          </section>
          <section>
            <h2>Example</h2>
            <div id="example1" class="d3">
              <button class="data-toggle button">Toggle Data Stream</button>
              <div class="chart"></div>
            </div>
          </section>
				</section>

        <section>
          <section>
            <h2>D3 <3<span style="text-transform: lowercase;">s</span> Arrays</h2>
            <ul>
              <li>D3 spends lots of time manipulating arrays</li>
              <li>.min, .max, .extent, .sum, .median, .mean, .quantile, .bisect</li>
              <li>Also provides simple interface to sort and filter data</li>
            </ul>
          </section>
          <section>
            <h3>Filtering</h3>
            <ul>
              <li>Take the following objects as our data</li>
            </ul>
            <pre><code class="javascript" data-trim>
var data = [
  {expense: 10, category: "Retail"},
  {expense: 15, category: "Gas"},
  {expense: 30, category: "Retail"},
  {expense: 50, category: "Dining"},
  {expense: 80, category: "Gas"},
  {expense: 65, category: "Retail"},
  {expense: 55, category: "Gas"},
  {expense: 30, category: "Dining"},
  {expense: 20, category: "Retail"},
  {expense: 10, category: "Dining"},
  {expense: 8, category: "Gas"}
];
          </code></pre>
          </section>
          <section>
            <h3>Updating with Objects &amp; Filters</h3>
            <pre><code class="javascript" data-trim>
function render(data, category) {
// Enter (add h-bar and a span)
// Exit (remove)
// Update
d3.select("#example2 .chart").selectAll("div.h-bar")
    .data(data)
  .attr("class", "h-bar")
  .style("width", function (d) {
    return (d.expense * 5) + "px";}
  )
  .select("span")
    .text(function (d) {
      return d.category;
    });
// Filter
d3.select("#example2 .chart").selectAll("div.h-bar")
  .filter(function (d, i) {
    return d.category == category;
  })
  .classed("selected", true);
}
            </code></pre>
          </section>
          <section>
            <h3>Filter on click</h3>
            <ul>
              <li>The render and render with filter</li>
            </ul>
            <pre><code class="javascript" data-trim>
render(data);

function select(category) {
  render(data, category);
}
            </code></pre>
            <ul>
              <li>A filter button example</li>
            </ul>
            <pre><code class="html" data-trim>
<button onclick="select('Retail')">Retail</button>
            </code></pre>
          </section>
          <section>
            <h3>The Filterable Chart</h3>
            <div id="example2">
              <div class="chart"></div>
              <div class="filters">
                <button class="category" data-filter="Retail">Retail</button>
                <button class="category" data-filter="Gas">Gas</button>
                <button class="category" data-filter="Dining">Dining</button>
                <button class="category" data-filter="">Clear</button>
              </div>
            </div>
          </section>
          <section>
            <h3>Sorting</h3>
            <ul>
              <li>Comparator takes two items, makes comparison, and orders based on return value</li>
            </ul>
            <pre><code class="javascript" data-trim>
// Replace filter snippet with the following
if(comparator) {
  d3.select("body")
    .selectAll("div.h-bar")
    .sort(comparator);
}
// Comparator functions
var compareByExpense = function (a, b) {
  return a.expense < b.expense?-1:1;
};
var compareByCategory = function (a, b) {
  return a.category < b.category?-1:1;
};
            </code></pre>
          </section>
          <section>
            <h3>Sort on Click</h3>
            <ul>
              <li>The render and render with filter</li>
            </ul>
            <pre><code class="javascript" data-trim>
render(data);

function sort(comparator) {
  render(data, comparator);
}
            </code></pre>
            <ul>
              <li>A sort button example</li>
            </ul>
            <pre><code class="html" data-trim>
<button onclick="sort(compareByExpense)">Sort by Expense</button>
            </code></pre>
          </section>
          <section>
            <h3>The Sortable Chart</h3>
            <div id="example3">
              <div class="chart"></div>
              <div class="sorters">
                <button data-comparator="compareByExpense">Compare by Expense</button>
                <button data-comparator="compareByCategory">Compare by Category</button>
                <button data-comparator="reset">Reset</button>
              </div>
            </div>
          </section>
        </section>

        <section>
          <section>
            <h2>Scale</h2>
            <ul>
              <li>Translates data to an understandable visual representation</li>
              <li>Domain - input</li>
              <li>Range - translated output</li>
              <li>Can translate a number range to a color range</li>
              <li>Are used when setting up axes</li>
              <li>linear, power, log, time, ordinal</li>
              <li>Interpolation</li>
            </ul>
            <pre><code class="javascript" data-trim>
// Simple linear scale mapping numbers 0 through 100
// to colors #add8e6 through blue
var colorScale = d3.scale.linear()
  .domain([0,100])
  .range(["#add8e6", "blue"]);
            </code></pre>
          </section>
          <section>
            <h2>Using a scale in Update</h2>
            <pre><code class="javascript" data-trim>
// Data as objects
var data = [{width: 10, color: 23},{width: 15, color: 33}...];
// Update with scale
d3.select("#example4 .chart").selectAll("div.h-bar")
  .data(data)
    .attr("class", "h-bar")
      .style("width", function(d) {
        return (d.width * 5) + "px";
      })
      .style("background-color", function(d) {
        return colorScale(d.color);
      })
    .select("span")
      .text(function(d) {
        return d.width;
      });
            </code></pre>
          </section>
          <section>
            <h3>Color Scale Example</h3>
            <div id="example4">
              <button class="data-toggle button">Toggle Data Stream</button>
              <div class="chart"></div>
            </div>
          </section>
        </section>

        <section>
          <section>
            <h2>Axes!</h2>
            <ul>
              <li>.axis method helps to construct axes</li>
              <li>Customize with .scale, .ticks, .orient</li>
            </ul>
            <pre><code class="javascript" data-trim>
function renderAxis(scale, i, orient) {
  var axis = d3.svg.axis()
    .scale(scale)
    .orient(orient)
    .ticks(5);

  svg.append("g")
    .attr("transform", function () {
      if (["top", "bottom"].indexOf(orient) >= 0) {
        return "translate(" + margin + "," + i * offset + ")";
      } else {
        return "translate(" + i * offset + ", " + margin + ")";
      }
    })
    .call(axis);
}
            </code></pre>
          </section>
          <section>
            <h3>Some Axes</h3>
            <div id="example5">
              <div class="control-group">
                <button data-orient="bottom">Horizontal bottom</button>
                <button data-orient="top">horizontal top</button>
                <button data-orient="left">Vertical left</button>
                <button data-orient="right">Vertical right</button>
              </div>
              <div class="chart"></div>
            </div>
          </section>
          <section>
            <h3>Get some grid lines</h3>
            <ul>
              <li>Render flexible gridlines by drawing lines at each tick</li>
              <li>D3 decides where ticks go with input from you</li>
            </ul>
            <pre><code class="javascript" data-trim>
function renderXGridlines() {
  var lines = d3.selectAll("g.x-axis g.tick")
    .select("line.grid-line")
    .remove();

  lines = d3.selectAll("g.x-axis g.tick")
    .append("line")
    .classed("grid-line", true)

  lines.attr("x1", 0)
    .attr("y1", 0)
    .attr("x2", 0)
    .attr("y2", -yAxisLength);
}
            </code></pre>
          </section>
          <section>
            <h3>And add Transition!</h3>
            <ul>
              <li>Use the same chart setup for any data</li>
              <li>.max is used to set the domain, and can be adjusted on the fly to dynamically adjust the chart when data changes</li>
              <li>D3 provides many ways to simply add transitions</li>
            </ul>
            <pre><code class="javascript" data-trim>
// initial yAxis declaration, scale previously established
yAxis = d3.svg.axis()
  .scale(scale)
  .tickSubdivide(1)
  .orient("left");

// On rescale, change domain to the new max value of dataset
yAxis.scale().domain([max, 0]);
svg.select("g.y-axis")
  .transition()      // <-- This makes everything smooth
    .duration(1000)  // But it was so easy!?
  .call(yAxis);
            </code></pre>
          </section>
          <section>
            <h3>Axes and Grid lines</h3>
            <div id="example6">
              <div class="control-group">
                <button>Randomly Rescale</button>
                <div class="chart"></div>
              </div>
            </div>
          </section>
        </section>
        <section>
          <section>
            <h2>Some other examples</h2>
            <ul>
              <li>This has just been the basic</li>
              <li>Maps, motion, connections, line, spline, pie, etc..</li>
              <li>Check out tons of implementations at <a href="http://d3js.org" target="_blank">d3js.org</a> and <a href="https://github.com/mbostock/d3/wiki/Gallery" target="_blank">github</a> and <a href="http://bl.ocks.org/mbostock" target="_blank">here</a></li>
            </ul>
          </section>
          <section>
            <h3>Object-Identity</h3>
            <ul>
              <li>Keep object consistency throughout visualization</li>
            </ul>
            <div id="example8">
              <div class="chart"></div>
            </div>
          </section>
          <section>
            <h3>Bubble Chart</h3>
            <div id="example9">
              <div class="control-group">
                <button>Update</button>
              </div>
              <div class="chart"></div>
            </div>
          </section>
          <section>
            <h3>Topography</h3>
            <div id="example7">
              <div class="chart"></div>
            </div>
          </section>
        </section>

        <section>
          <h2>D3 and Drupal</h2>
          <ul>
            <li>Next steps:</li>
            <li>What ways Drupal can output data in a convenient format</li>
            <li>Make some simple prototypes within Drupal</li>
          </ul>
        </section>
			</div>

		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>

			// Full list of configuration options available at:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,

				transition: 'slide', // none/fade/slide/convex/concave/zoom

				// Optional reveal.js plugins
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, condition: function() { return !!document.querySelector( 'pre code' ); }, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true },
					{ src: 'plugin/notes/notes.js', async: true }
				]
			});

		</script>
		<script src="js/jquery-1.11.3.js"></script>
    <script src="js/d3.js"></script>
    <script type="text/javascript" src="js/topojson.js"></script>
		<script src="js/custom.js"></script>

	</body>
</html>
